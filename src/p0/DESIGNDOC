			+-------------------------+
			|        CS 318           |
			| PROJECT 0: Getting Real |
			|     DESIGN DOCUMENT     |
			+-------------------------+
				   
---- AUTHOR ----

>> Fill in your name and email address.

Ding Zhao <dzhao29@jh.edu>

---- PRELIMINARIES ----

>> If you have any preliminary comments on your submission, notes for the
>> TAs, or extra credit, please give them here.

>> Please cite any offline or online sources you consulted while
>> preparing your submission, other than the Pintos documentation, course
>> text, lecture notes, and course staff.

			     Booting Pintos
			     ==============

---- QUESTIONS ---- 
>> Put the screenshots of Pintos running in src/p0.
>> A1: Is there any particular issue that you would like us to know?
No

			     Debugging
			     =========

---- QUESTIONS: BIOS ---- 
>> B1: What is the first instruction that gets executed?
ljmp   $0x3630,$0xf000e05b
>> B2: At which physical address is this instruction located?
0xF0000 + 0xFFF0 = 0xFFFF0
>> B3: Can you guess why the first instruction is like this?

>> B4: What are the next three instructions?
cmpw   $0xffc8,%cs:(%esi)
jne    0xd241d0b2
xor    %edx,%edx

---- QUESTIONS: BOOTLOADER ---- 
>> B5: How does the bootloader read disk sectors? In particular, what BIOS interrupt
is used?
int $0x13

>> B6: How does the bootloader decides whether it successfully finds the Pintos kernel?
Read the partition table on each system hard disk and scan for a partition of type 0x20, which is the type that is used for a Pintos kernel.

>> B7: What happens when the bootloader could not find the Pintos kernel?
The bootloader gives up loading kernel, prints the error message "Not found" and notifies BIOS that boot failed using int $0x18.

>> B8: At what point and how exactly does the bootloader transfer control to the Pintos kernel?
The bootloader transfers control to the Pintos kernel after it has located a valid Pintos partition and finished loading all kernel sectors into memory.

It reads the kernelâ€™s entry point from the ELF header, converts this address into a real-mode segment:offset form, and performs a far jump (ljmp *start) to that address to begin kernel execution.

---- QUESTIONS: KERNEL ---- 
>> B9: At the entry of pintos_init(), what is the value of expression 
init_page_dir[pd_no(ptov(0))] in hexadecimal format?
0x0

>> B10: When palloc_get_page() is called for the first time,

>> B10.1 what does the call stack look like?
#0  palloc_get_page (flags=(PAL_ASSERT | PAL_ZERO)) at ../../threads/palloc.c:113
#1  0xc0020549 in paging_init () at ../../threads/init.c:221
#2  0xc002031b in pintos_init () at ../../threads/init.c:100
#3  0xc002013d in start () at ../../threads/start.S:180

>> B10.2 what is the return value in hexadecimal format?
Value returned is $3 = (void *) 0xc0101000

>> B10.3 what is the value of expression init_page_dir[pd_no(ptov(0))] in hexadecimal format?
0x0

>> B11: When palloc_get_page() is called for the third time,

>> B11.1 what does the call stack look like?
#0  palloc_get_page (flags=PAL_ZERO) at ../../threads/palloc.c:113
#1  0xc0020c20 in thread_create (name=0xc002eabd "idle", priority=0, 
function=0xc002104f <idle>, aux=0xc000efac) at ../../threads/thread.c:178
#2  0xc0020b15 in thread_start () at ../../threads/thread.c:111
#3  0xc0020334 in pintos_init () at ../../threads/init.c:119
#4  0xc002013d in start () at ../../threads/start.S:180

>> B11.2 what is the return value in hexadecimal format?
Value returned is $5 = (void *) 0xc0103000

>> B11.3 what is the value of expression init_page_dir[pd_no(ptov(0))] in hexadecimal format?
0x102027

			     Kernel Monitor
			     ==============

---- DATA STRUCTURES ----

>> C1: Copy here the declaration of each new or changed `struct' or
>> `struct' member, global or static variable, `typedef', or
>> enumeration.  Identify the purpose of each in 25 words or less.

---- ALGORITHMS ----
>> C2: Explain how you read and write to the console for the kernel monitor.
Read: input_getc () (Retrieves a key from the input buffer. If the buffer is empty, waits for a key to be pressed)
Write: printf () (Writes formatted output to the console)
>> C3: Any additional enhancement you implement?
Handling special input (backspace) is implemented.
